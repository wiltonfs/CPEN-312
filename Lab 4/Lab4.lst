                 -1   $MODDE0CV ; Special Function Registers declaration for CV-8052
0000              1   ;  MODDDE2: Register definition for DE2-8052 softcore
0000              2   ;
0000              3   ;   Copyright (C) 2011  Jesus Calvino-Fraga, jesusc at ece.ubc.ca
0000              4   ;
0000              5   ;   This library is free software; you can redistribute it and/or
0000              6   ;   modify it under the terms of the GNU Lesser General Public
0000              7   ;   License as published by the Free Software Foundation; either
0000              8   ;   version 2.1 of the License, or (at your option) any later version.
0000              9   ;
0000             10   ;   This library is distributed in the hope that it will be useful,
0000             11   ;   but WITHOUT ANY WARRANTY; without even the implied warranty of
0000             12   ;   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
0000             13   ;   Lesser General Public License for more details.
0000             14   ;
0000             15   ;   You should have received a copy of the GNU Lesser General Public
0000             16   ;   License along with this library; if not, write to the Free Software
0000             17   ;   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
0000             18   ;
0000             19       
0000             20   P0     DATA  080H  ;PORT 0
0000             21   SP     DATA  081H  ;STACK POINTER
0000             22   DPL    DATA  082H  ;DATA POINTER 0 - LOW BYTE
0000             23   DPH    DATA  083H  ;DATA POINTER 0 - HIGH BYTE
0000             24   DPL1   DATA  084H  ;DATA POINTER 1 - LOW BYTE
0000             25   DPH1   DATA  085H  ;DATA POINTER 1 - HIGH BYTE
0000             26   DPS    DATA  086H  ;DATA POINTER SELECT. DPH1, DPL1 active when DPS.0=1
0000             27   PCON   DATA  087H  ;POWER CONTROL
0000             28   TCON   DATA  088H  ;TIMER CONTROL
0000             29   TMOD   DATA  089H  ;TIMER MODE
0000             30   TL0    DATA  08AH  ;TIMER 0 - LOW BYTE
0000             31   TL1    DATA  08BH  ;TIMER 1 - LOW BYTE
0000             32   TH0    DATA  08CH  ;TIMER 0 - HIGH BYTE
0000             33   TH1    DATA  08DH  ;TIMER 1 - HIGH BYTE
0000             34   P1     DATA  090H  ;PORT 1
0000             35   SCON   DATA  098H  ;SERIAL PORT CONTROL
0000             36   SBUF   DATA  099H  ;SERIAL PORT BUFFER
0000             37   P2     DATA  0A0H  ;PORT 2
0000             38   IE     DATA  0A8H  ;INTERRUPT ENABLE
0000             39   P3     DATA  0B0H  ;PORT 3
0000             40   IP     DATA  0B8H  ;INTERRUPT PRIORITY
0000             41   T2CON  DATA  0C8H  ;TIMER 2 CONTROL
0000             42   T2MOD  DATA  0C9H  ;TIMER 2 MODE
0000             43   RCAP2L DATA  0CAH  ;TIMER 2 CAPTURE REGISTER - LOW BYTE
0000             44   RCAP2H DATA  0CBH  ;TIMER 2 CAPTURE REGISTER - HIGH BYTE
0000             45   TL2    DATA  0CCH  ;TIMER 2 - LOW BYTE
0000             46   TH2    DATA  0CDH  ;TIMER 2 - HIGH BYTE
0000             47   PSW    DATA  0D0H  ;PROGRAM STATUS WORD
0000             48   ACC    DATA  0E0H  ;ACCUMULATOR
0000             49   B      DATA  0F0H  ;MULTIPLICATION REGISTER
0000             50   IT0    BIT   088H  ;TCON.0 - EXT. INTERRUPT 0 TYPE
0000             51   IE0    BIT   089H  ;TCON.1 - EXT. INTERRUPT 0 EDGE FLAG
0000             52   IT1    BIT   08AH  ;TCON.2 - EXT. INTERRUPT 1 TYPE
0000             53   IE1    BIT   08BH  ;TCON.3 - EXT. INTERRUPT 1 EDGE FLAG
0000             54   TR0    BIT   08CH  ;TCON.4 - TIMER 0 ON/OFF CONTROL
0000             55   TF0    BIT   08DH  ;TCON.5 - TIMER 0 OVERFLOW FLAG
0000             56   TR1    BIT   08EH  ;TCON.6 - TIMER 1 ON/OFF CONTROL
0000             57   TF1    BIT   08FH  ;TCON.7 - TIMER 1 OVERFLOW FLAG
0000             58   RI     BIT   098H  ;SCON.0 - RECEIVE INTERRUPT FLAG
0000             59   TI     BIT   099H  ;SCON.1 - TRANSMIT INTERRUPT FLAG
0000             60   RB8    BIT   09AH  ;SCON.2 - RECEIVE BIT 8
0000             61   TB8    BIT   09BH  ;SCON.3 - TRANSMIT BIT 8
0000             62   REN    BIT   09CH  ;SCON.4 - RECEIVE ENABLE
0000             63   SM2    BIT   09DH  ;SCON.5 - SERIAL MODE CONTROL BIT 2
0000             64   SM1    BIT   09EH  ;SCON.6 - SERIAL MODE CONTROL BIT 1
0000             65   SM0    BIT   09FH  ;SCON.7 - SERIAL MODE CONTROL BIT 0
0000             66   EX0    BIT   0A8H  ;IE.0 - EXTERNAL INTERRUPT 0 ENABLE
0000             67   ET0    BIT   0A9H  ;IE.1 - TIMER 0 INTERRUPT ENABLE
0000             68   EX1    BIT   0AAH  ;IE.2 - EXTERNAL INTERRUPT 1 ENABLE
0000             69   ET1    BIT   0ABH  ;IE.3 - TIMER 1 INTERRUPT ENABLE
0000             70   ES     BIT   0ACH  ;IE.4 - SERIAL PORT INTERRUPT ENABLE
0000             71   ET2    BIT   0ADH  ;IE.5 - TIMER 2 INTERRUPT ENABLE
0000             72   EA     BIT   0AFH  ;IE.7 - GLOBAL INTERRUPT ENABLE
0000             73   RXD    BIT   0B0H  ;P3.0 - SERIAL PORT RECEIVE INPUT
0000             74   TXD    BIT   0B1H  ;P3.1 - SERIAL PORT TRANSMIT OUTPUT
0000             75   INT0   BIT   0B2H  ;P3.2 - EXTERNAL INTERRUPT 0 INPUT
0000             76   INT1   BIT   0B3H  ;P3.3 - EXTERNAL INTERRUPT 1 INPUT
0000             77   T0     BIT   0B4H  ;P3.4 - TIMER 0 COUNT INPUT
0000             78   T1     BIT   0B5H  ;P3.5 - TIMER 1 COUNT INPUT
0000             79   WR     BIT   0B6H  ;P3.6 - WRITE CONTROL FOR EXT. MEMORY
0000             80   RD     BIT   0B7H  ;P3.7 - READ CONTROL FOR EXT. MEMORY
0000             81   PX0    BIT   0B8H  ;IP.0 - EXTERNAL INTERRUPT 0 PRIORITY
0000             82   PT0    BIT   0B9H  ;IP.1 - TIMER 0 PRIORITY
0000             83   PX1    BIT   0BAH  ;IP.2 - EXTERNAL INTERRUPT 1 PRIORITY
0000             84   PT1    BIT   0BBH  ;IP.3 - TIMER 1 PRIORITY
0000             85   PS     BIT   0BCH  ;IP.4 - SERIAL PORT PRIORITY
0000             86   PT2    BIT   0BDH  ;IP.5 - TIMER 2 PRIORITY
0000             87   CAP2   BIT   0C8H  ;T2CON.0 - CAPTURE OR RELOAD SELECT
0000             88   CNT2   BIT   0C9H  ;T2CON.1 - TIMER OR COUNTER SELECT
0000             89   TR2    BIT   0CAH  ;T2CON.2 - TIMER 2 ON/OFF CONTROL
0000             90   EXEN2  BIT   0CBH  ;T2CON.3 - TIMER 2 EXTERNAL ENABLE FLAG
0000             91   TCLK   BIT   0CCH  ;T2CON.4 - TRANSMIT CLOCK SELECT
0000             92   RCLK   BIT   0CDH  ;T2CON.5 - RECEIVE CLOCK SELECTT
0000             93   EXF2   BIT   0CEH  ;T2CON.6 - EXTERNAL TRANSITION FLAG
0000             94   TF2    BIT   0CFH  ;T2CON.7 - TIMER 2 OVERFLOW FLAG
0000             95   P      BIT   0D0H  ;PSW.0 - ACCUMULATOR PARITY FLAG
0000             96   OV     BIT   0D2H  ;PSW.2 - OVERFLOW FLAG
0000             97   RS0    BIT   0D3H  ;PSW.3 - REGISTER BANK SELECT 0
0000             98   RS1    BIT   0D4H  ;PSW.4 - REGISTER BANK SELECT 1
0000             99   F0     BIT   0D5H  ;PSW.5 - FLAG 0
0000            100   AC     BIT   0D6H  ;PSW.6 - AUXILIARY CARRY FLAG
0000            101   CY     BIT   0D7H  ;PSW.7 - CARRY FLAG
0000            102   
0000            103   ; For the altera DE2 configured with an 8051/8052 softcore processor
0000            104   ; we have the following extra registers:
0000            105   
0000            106   HEX0   DATA  091H ; Zero turns the segment on
0000            107   HEX1   DATA  092H ; 
0000            108   HEX2   DATA  093H ; 
0000            109   HEX3   DATA  094H ; 
0000            110   HEX4   DATA  08EH ;
0000            111   HEX5   DATA  08FH ;
0000            112   HEX6   DATA  096H ;
0000            113   HEX7   DATA  097H ;
0000            114   
0000            115   P0MOD  DATA  09AH ; Input/output mode bits for port 0.  '1' sets the port to output mode.
0000            116   P1MOD  DATA  09BH ; Input/output mode bits for port 1
0000            117   P2MOD  DATA  09CH ; Input/output mode bits for port 2
0000            118   P3MOD  DATA  09DH ; Input/output mode bits for port 3
0000            119   
0000            120   LEDRA  DATA  0E8H ; LEDs LEDR0 to LEDR7 (bit addressable, ex: LEDRA.1 for LEDR1)
0000            121   LEDRB  DATA  095H ; LEDs LEDR8 to LEDR15
0000            122   LEDRC  DATA  09EH ; LEDs LEDR16, LEDR15, and LEDG8
0000            123   LEDG   DATA  0F8H ; LEDs LEDG0 to LEDG7 (bit addressable, ex: LEDG.3 for LEDG3)
0000            124   SWA    DATA  0E8H ; Switches SW0 to SW7 (bit addressable, ex: SWA.1 for SW1)
0000            125   SWB    DATA  095H ; Switches SW8 to SW15
0000            126   SWC    DATA  09EH ; Switches SW16 and SW17
0000            127   KEY    DATA  0F8H ; KEY1=KEY.1, KEY2=KEY.2, KEY3=KEY.3.  KEY0 is the reset button! 
0000            128   
0000            129   LCD_CMD   DATA 0D8H ;
0000            130   LCD_DATA  DATA 0D9H ;
0000            131   LCD_MOD   DATA 0DAH ; Write 0xff to make LCD_DATA an output
0000            132   LCD_RW    BIT  0D8H ; '0' writes to LCD
0000            133   LCD_EN    BIT  0D9H ; Toggle from '1' to '0'
0000            134   LCD_RS    BIT  0DAH ; '0' for commands, '1' for data
0000            135   LCD_ON    BIT  0DBH ; Write '1' to power the LCD
0000            136   LCD_BLON  BIT  0DCH ; Write '1' to turn on back light
0000            137   
0000            138   FLASH_CMD  data 0DBH ; The control bits of the flash memory:
0000            139   ; bit 0: FL_RST_N  Set to 1 for normal operation
0000            140   ; bit 1: FL_WE_N
0000            141   ; bit 2: FL_OE_N
0000            142   ; bit 3: FL_CE_N
0000            143   FLASH_DATA data 0DCH ; 8-bit data bus of flash memory.
0000            144   FLASH_MOD  data 0DDH ; 0xff makes FLASH_DATA output.  0x00 makes FLASH_DATA input.
0000            145   FLASH_ADD0 data 0E1H ; address bits 0 to 7.
0000            146   FLASH_ADD1 data 0E2H ; address bits 8 to 15.
0000            147   FLASH_ADD2 data 0E3H ; address bits 16 to 21.
0000            148   
0000              2   
0000              3   org 0000H ; Which code memory location to start at after reset
0000 020152       4            ljmp pgrmstart  ; jump down to the label called "pgrmstart"
0003              5   
0003              6   ;These three values are associated with the timing of the circuit
0003              7   ;Tune them to set the "heartbeat" of the program
0003              8   ;The time between "heartbeats" is a function of product of these three
0003              9   ;But none of them can be over 255 (8 bit)
0003             10   S_TICKS EQU #100
0003             11   M_TICKS EQU #70
0003             12   M_TICKS_DOUBLE EQU #140
0003             13   L_TICKS EQU #150
0003             14   
0003             15   ; Look-up table for my student number, blank, and HELLO
0003             16   ; My student num: 48059760
0003             17   T_StuNum:
0003             18            ;       0       6         7        9    5        0        8        4    
0003 40027810    19            DB 40H, 02H, 78H, 10H, 12H, 40H, 00H, 19H
     12400019
000B             20            ; BLANK
000B 7F          21            DB 7FH
000C             22            ;   H    E        L        O
000C 8986C740    23            DB 89H, 86H, 0xC7H, 40H
0010             24            ;       C        P         N            3         1    2
0010 C68CC8B0    25            DB 0xC6H, 8CH, 0xC8H, 0xB0H, 0xF9H, 0xA4H
     F9A4
0016             26   
0016             27   ;This is a "function", it takes two parameters. These parameters can be accessed using %0 and %1
                 28   Display_on mac
                 29   	mov dptr, #T_StuNum ; point to student number lookup table
                 30   	mov a, %1 ; Load second input into accumulator
                 31   	movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
                 32   	mov %0, a ; Display number to given (first input) register
                 33   endmac
0016             34   
0016             35   ;This is a "function", it takes no parameters. It just displays the first 6 digits of my student number
                 36   Most_sig mac
                 37   	Display_on(r4, #00)
                 38   	Display_on(r5, #01)
                 39   	Display_on(HEX0, #02)
                 40   	Display_on(HEX1, #03)
                 41   	Display_on(HEX2, #04)
                 42   	Display_on(HEX3, #05)
                 43   	Display_on(HEX4, #06)
                 44   	Display_on(HEX5, #07)
                 45   endmac
0016             46   
0016             47   ;This is a "function", it takes no parameters. It just displays all blank
                 48   All_blnk mac
                 49   	Display_on(HEX0, #08)
                 50   	Display_on(HEX1, #08)
                 51   	Display_on(HEX2, #08)
                 52   	Display_on(HEX3, #08)
                 53   	Display_on(HEX4, #08)
                 54   	Display_on(HEX5, #08)
                 55   endmac
0016             56   
0016             57   ;This is a "function", it takes no parameters. It just displays the last 6 digits of my student number
                 58   Least_sig mac
                 59   	Display_on(HEX0, #00)
                 60   	Display_on(HEX1, #01)
                 61   	Display_on(HEX2, #02)
                 62   	Display_on(HEX3, #03)
                 63   	Display_on(HEX4, #04)
                 64   	Display_on(HEX5, #05)
                 65   endmac
0016             66   
0016             67   ;This is a "function", it takes no parameters. It just displays HELLO
                 68   Hello mac
                 69   	Display_on(HEX0, #08H)
                 70   	Display_on(HEX1, #12)
                 71   	Display_on(HEX2, #11)
                 72   	Display_on(HEX3, #11)
                 73   	Display_on(HEX4, #10)
                 74   	Display_on(HEX5, #09H)
                 75   endmac
0016             76   
0016             77   ;This is a "function", it takes no parameters. It just displays CPN312
                 78   CPN312 mac
                 79   	Display_on(HEX0, #18)
                 80   	Display_on(HEX1, #17)
                 81   	Display_on(HEX2, #16)
                 82   	Display_on(HEX3, #15)
                 83   	Display_on(HEX4, #14)
                 84   	Display_on(HEX5, #13)
                 85   endmac
0016             86   
0016             87   MODE6LONG:
0016             88            ; Mode 6 - Hello() Most_sig() CPN312()
0016             89            ; if r4 == 0, Hello
0016 BC0043      90            CJNE r4, #00, MODE6JUMP1
0019 900003      91            mov dptr, #T_StuNum ; point to student number lookup table
001C 7400        91            mov a, #00 ; Load second input into accumulator
001E 93          91            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
001F FC          91            mov r4, a ; Display number to given (first input) register
0020 900003      91            mov dptr, #T_StuNum ; point to student number lookup table
0023 7401        91            mov a, #01 ; Load second input into accumulator
0025 93          91            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0026 FD          91            mov r5, a ; Display number to given (first input) register
0027 900003      91            mov dptr, #T_StuNum ; point to student number lookup table
002A 7402        91            mov a, #02 ; Load second input into accumulator
002C 93          91            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
002D F591        91            mov HEX0, a ; Display number to given (first input) register
002F 900003      91            mov dptr, #T_StuNum ; point to student number lookup table
0032 7403        91            mov a, #03 ; Load second input into accumulator
0034 93          91            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0035 F592        91            mov HEX1, a ; Display number to given (first input) register
0037 900003      91            mov dptr, #T_StuNum ; point to student number lookup table
003A 7404        91            mov a, #04 ; Load second input into accumulator
003C 93          91            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
003D F593        91            mov HEX2, a ; Display number to given (first input) register
003F 900003      91            mov dptr, #T_StuNum ; point to student number lookup table
0042 7405        91            mov a, #05 ; Load second input into accumulator
0044 93          91            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0045 F594        91            mov HEX3, a ; Display number to given (first input) register
0047 900003      91            mov dptr, #T_StuNum ; point to student number lookup table
004A 7406        91            mov a, #06 ; Load second input into accumulator
004C 93          91            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
004D F58E        91            mov HEX4, a ; Display number to given (first input) register
004F 900003      91            mov dptr, #T_StuNum ; point to student number lookup table
0052 7407        91            mov a, #07 ; Load second input into accumulator
0054 93          91            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0055 F58F        91            mov HEX5, a ; Display number to given (first input) register
0057 7C01        92            mov r4, #01
0059 02046F      93            ljmp ENDTIME
005C             94            MODE6JUMP1:     
005C BC0135      95            CJNE r4, #01, MODE6JUMP2
005F 900003      96            mov dptr, #T_StuNum ; point to student number lookup table
0062 7412        96            mov a, #18 ; Load second input into accumulator
0064 93          96            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0065 F591        96            mov HEX0, a ; Display number to given (first input) register
0067 900003      96            mov dptr, #T_StuNum ; point to student number lookup table
006A 7411        96            mov a, #17 ; Load second input into accumulator
006C 93          96            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
006D F592        96            mov HEX1, a ; Display number to given (first input) register
006F 900003      96            mov dptr, #T_StuNum ; point to student number lookup table
0072 7410        96            mov a, #16 ; Load second input into accumulator
0074 93          96            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0075 F593        96            mov HEX2, a ; Display number to given (first input) register
0077 900003      96            mov dptr, #T_StuNum ; point to student number lookup table
007A 740F        96            mov a, #15 ; Load second input into accumulator
007C 93          96            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
007D F594        96            mov HEX3, a ; Display number to given (first input) register
007F 900003      96            mov dptr, #T_StuNum ; point to student number lookup table
0082 740E        96            mov a, #14 ; Load second input into accumulator
0084 93          96            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0085 F58E        96            mov HEX4, a ; Display number to given (first input) register
0087 900003      96            mov dptr, #T_StuNum ; point to student number lookup table
008A 740D        96            mov a, #13 ; Load second input into accumulator
008C 93          96            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
008D F58F        96            mov HEX5, a ; Display number to given (first input) register
008F 7C02        97            mov r4, #02
0091 02046F      98            ljmp ENDTIME
0094             99            MODE6JUMP2:
0094 900003     100            mov dptr, #T_StuNum ; point to student number lookup table
0097 7408       100            mov a, #08H ; Load second input into accumulator
0099 93         100            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
009A F591       100            mov HEX0, a ; Display number to given (first input) register
009C 900003     100            mov dptr, #T_StuNum ; point to student number lookup table
009F 740C       100            mov a, #12 ; Load second input into accumulator
00A1 93         100            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
00A2 F592       100            mov HEX1, a ; Display number to given (first input) register
00A4 900003     100            mov dptr, #T_StuNum ; point to student number lookup table
00A7 740B       100            mov a, #11 ; Load second input into accumulator
00A9 93         100            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
00AA F593       100            mov HEX2, a ; Display number to given (first input) register
00AC 900003     100            mov dptr, #T_StuNum ; point to student number lookup table
00AF 740B       100            mov a, #11 ; Load second input into accumulator
00B1 93         100            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
00B2 F594       100            mov HEX3, a ; Display number to given (first input) register
00B4 900003     100            mov dptr, #T_StuNum ; point to student number lookup table
00B7 740A       100            mov a, #10 ; Load second input into accumulator
00B9 93         100            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
00BA F58E       100            mov HEX4, a ; Display number to given (first input) register
00BC 900003     100            mov dptr, #T_StuNum ; point to student number lookup table
00BF 7409       100            mov a, #09H ; Load second input into accumulator
00C1 93         100            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
00C2 F58F       100            mov HEX5, a ; Display number to given (first input) register
00C4 7C00       101            mov r4, #00
00C6 02046F     102            ljmp ENDTIME
00C9            103            
00C9            104   MODE5LONG:
00C9            105            ; Mode 5 - build it one by one
00C9            106            ; if r4 == 0, Blank
00C9 BC0033     107            CJNE r4, #00, MODE5JUMP1
00CC 900003     108            mov dptr, #T_StuNum ; point to student number lookup table
00CF 7408       108            mov a, #08 ; Load second input into accumulator
00D1 93         108            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
00D2 F591       108            mov HEX0, a ; Display number to given (first input) register
00D4 900003     108            mov dptr, #T_StuNum ; point to student number lookup table
00D7 7408       108            mov a, #08 ; Load second input into accumulator
00D9 93         108            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
00DA F592       108            mov HEX1, a ; Display number to given (first input) register
00DC 900003     108            mov dptr, #T_StuNum ; point to student number lookup table
00DF 7408       108            mov a, #08 ; Load second input into accumulator
00E1 93         108            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
00E2 F593       108            mov HEX2, a ; Display number to given (first input) register
00E4 900003     108            mov dptr, #T_StuNum ; point to student number lookup table
00E7 7408       108            mov a, #08 ; Load second input into accumulator
00E9 93         108            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
00EA F594       108            mov HEX3, a ; Display number to given (first input) register
00EC 900003     108            mov dptr, #T_StuNum ; point to student number lookup table
00EF 7408       108            mov a, #08 ; Load second input into accumulator
00F1 93         108            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
00F2 F58E       108            mov HEX4, a ; Display number to given (first input) register
00F4 900003     108            mov dptr, #T_StuNum ; point to student number lookup table
00F7 7408       108            mov a, #08 ; Load second input into accumulator
00F9 93         108            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
00FA F58F       108            mov HEX5, a ; Display number to given (first input) register
00FC 02046F     109            ljmp ENDTIME
00FF            110            MODE5JUMP1:     
00FF BC010B     111            CJNE r4, #01, MODE5JUMP2
0102 900003     112            mov dptr, #T_StuNum ; point to student number lookup table
0105 7407       112            mov a, #07 ; Load second input into accumulator
0107 93         112            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0108 F58F       112            mov HEX5, a ; Display number to given (first input) register
010A 02046F     113            ljmp ENDTIME
010D            114            MODE5JUMP2:
010D BC020B     115            CJNE r4, #02, MODE5JUMP3
0110 900003     116            mov dptr, #T_StuNum ; point to student number lookup table
0113 7406       116            mov a, #06 ; Load second input into accumulator
0115 93         116            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0116 F58E       116            mov HEX4, a ; Display number to given (first input) register
0118 02046F     117            ljmp ENDTIME
011B            118            MODE5JUMP3:
011B BC030B     119            CJNE r4, #03, MODE5JUMP4
011E 900003     120            mov dptr, #T_StuNum ; point to student number lookup table
0121 7405       120            mov a, #05 ; Load second input into accumulator
0123 93         120            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0124 F594       120            mov HEX3, a ; Display number to given (first input) register
0126 02046F     121            ljmp ENDTIME
0129            122            MODE5JUMP4:
0129 BC040B     123            CJNE r4, #04, MODE5JUMP5
012C 900003     124            mov dptr, #T_StuNum ; point to student number lookup table
012F 7404       124            mov a, #04 ; Load second input into accumulator
0131 93         124            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0132 F593       124            mov HEX2, a ; Display number to given (first input) register
0134 02046F     125            ljmp ENDTIME
0137            126            MODE5JUMP5:
0137 BC050B     127            CJNE r4, #05, MODE5JUMP6
013A 900003     128            mov dptr, #T_StuNum ; point to student number lookup table
013D 7403       128            mov a, #03 ; Load second input into accumulator
013F 93         128            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0140 F592       128            mov HEX1, a ; Display number to given (first input) register
0142 02046F     129            ljmp ENDTIME
0145            130            MODE5JUMP6: ; else case
0145 900003     131            mov dptr, #T_StuNum ; point to student number lookup table
0148 7402       131            mov a, #02 ; Load second input into accumulator
014A 93         131            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
014B F591       131            mov HEX0, a ; Display number to given (first input) register
014D 7CFF       132            mov r4, #0xFFH ; to make sure it overflows
014F 02046F     133            ljmp ENDTIME
0152            134            
0152            135            
0152            136            
0152            137            
0152            138            
0152            139            
0152            140            
0152            141   
0152            142   ;This is a "function", it takes no parameters. It just displays the custom display for mode 7
                143   Custom_disp mac
                144   	; remove 03 and 06
                145   	Display_on(HEX0, #00)
                146   	Display_on(HEX1, #01)
                147   	Display_on(HEX2, #02)
                148   	Display_on(HEX3, #04)
                149   	Display_on(HEX4, #05)
                150   	Display_on(HEX5, #07)
                151   endmac
0152            152   
                153   Scrll_left mac
                154   	mov b, r5 ; "temp" keep
                155   	
                156   	mov a, r4
                157   	mov r5, a
                158   	mov r4, HEX5
                159   	mov HEX5, HEX4
                160   	mov HEX4, HEX3
                161   	mov HEX3, HEX2
                162   	mov HEX2, HEX1
                163   	mov HEX1, HEX0
                164   	mov HEX0, b
                165   endmac
0152            166   
                167   Scrll_right mac
                168   	mov b, HEX0 ; "temp" keep
                169   	
                170   	mov HEX0, HEX1
                171   	mov HEX1, HEX2
                172   	mov HEX2, HEX3
                173   	mov HEX3, HEX4
                174   	mov HEX4, HEX5
                175   	mov HEX5, r4
                176   	mov a, r5
                177   	mov r4, a
                178   	mov r5, b
                179   endmac
0152            180   
0152            181   ; The code under this label runs once, when the program starts
0152            182   pgrmstart:
0152            183            ; Turns off LEDs and stuff
0152 75817F     184            mov SP, #0x7f
0155 75E800     185            mov LEDRA, #0 ; Bit addressable
0158 759500     186            mov LEDRB, #0 ; Not bit addressable
015B            187            
015B            188            ; Start timer
015B 7964       189            mov r1, S_TICKS
015D 7A46       190            mov r2, M_TICKS
015F 7B96       191            mov r3, L_TICKS
0161            192            
0161            193            
0161            194            
0161            195            ; Mode 0 by default, display first 6 digits
0161 900003     196            mov dptr, #T_StuNum ; point to student number lookup table
0164 7400       196            mov a, #00 ; Load second input into accumulator
0166 93         196            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0167 FC         196            mov r4, a ; Display number to given (first input) register
0168 900003     196            mov dptr, #T_StuNum ; point to student number lookup table
016B 7401       196            mov a, #01 ; Load second input into accumulator
016D 93         196            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
016E FD         196            mov r5, a ; Display number to given (first input) register
016F 900003     196            mov dptr, #T_StuNum ; point to student number lookup table
0172 7402       196            mov a, #02 ; Load second input into accumulator
0174 93         196            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0175 F591       196            mov HEX0, a ; Display number to given (first input) register
0177 900003     196            mov dptr, #T_StuNum ; point to student number lookup table
017A 7403       196            mov a, #03 ; Load second input into accumulator
017C 93         196            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
017D F592       196            mov HEX1, a ; Display number to given (first input) register
017F 900003     196            mov dptr, #T_StuNum ; point to student number lookup table
0182 7404       196            mov a, #04 ; Load second input into accumulator
0184 93         196            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0185 F593       196            mov HEX2, a ; Display number to given (first input) register
0187 900003     196            mov dptr, #T_StuNum ; point to student number lookup table
018A 7405       196            mov a, #05 ; Load second input into accumulator
018C 93         196            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
018D F594       196            mov HEX3, a ; Display number to given (first input) register
018F 900003     196            mov dptr, #T_StuNum ; point to student number lookup table
0192 7406       196            mov a, #06 ; Load second input into accumulator
0194 93         196            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0195 F58E       196            mov HEX4, a ; Display number to given (first input) register
0197 900003     196            mov dptr, #T_StuNum ; point to student number lookup table
019A 7407       196            mov a, #07 ; Load second input into accumulator
019C 93         196            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
019D F58F       196            mov HEX5, a ; Display number to given (first input) register
019F            197            
019F            198   ; The code under this label runs continuously
019F            199   loop:
019F            200            ; Latching logic
019F 20FB03     201            jb key.3, ENDLATCHtmp   ; jump if bit 3 of switch is = 1
01A2 0201A8     202            ljmp LATCHLOGIC
01A5 02039A     203   ENDLATCHtmp: ljmp ENDLATCH       ; I have to do this weird jumping bc jb can only jump up to 127 lines
01A8            204   
01A8            205   ; The code under this label has to do with latching our mode, and updating the display
01A8            206   ; to the "first frame" of that mode
01A8            207   LATCHLOGIC:
01A8            208            ; Evaluate initial display depending on mode
01A8 E5E8       209            mov a, SWA                                                      
01AA 5407       210            ANL a, #07                              ; strip A to only the least significant 3 values by ANDing it with 00000111 (Not strictly nesc.)
01AC F8         211            mov r0, a                               ; store switch values in r0
01AD            212            ; Think of this as a big Switch statement that finds what mode we are in
01AD            213            ; There is a better way to do this, as a lot of the modes have the same start
01AD            214            ; However, to start with this is a more clear way to see what is going on
01AD B80041     215            CJNE r0, #00, MODE1             ; jump if r0 != byte
01B0            216            ; Mode 0
01B0 900003     217            mov dptr, #T_StuNum ; point to student number lookup table
01B3 7400       217            mov a, #00 ; Load second input into accumulator
01B5 93         217            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
01B6 FC         217            mov r4, a ; Display number to given (first input) register
01B7 900003     217            mov dptr, #T_StuNum ; point to student number lookup table
01BA 7401       217            mov a, #01 ; Load second input into accumulator
01BC 93         217            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
01BD FD         217            mov r5, a ; Display number to given (first input) register
01BE 900003     217            mov dptr, #T_StuNum ; point to student number lookup table
01C1 7402       217            mov a, #02 ; Load second input into accumulator
01C3 93         217            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
01C4 F591       217            mov HEX0, a ; Display number to given (first input) register
01C6 900003     217            mov dptr, #T_StuNum ; point to student number lookup table
01C9 7403       217            mov a, #03 ; Load second input into accumulator
01CB 93         217            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
01CC F592       217            mov HEX1, a ; Display number to given (first input) register
01CE 900003     217            mov dptr, #T_StuNum ; point to student number lookup table
01D1 7404       217            mov a, #04 ; Load second input into accumulator
01D3 93         217            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
01D4 F593       217            mov HEX2, a ; Display number to given (first input) register
01D6 900003     217            mov dptr, #T_StuNum ; point to student number lookup table
01D9 7405       217            mov a, #05 ; Load second input into accumulator
01DB 93         217            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
01DC F594       217            mov HEX3, a ; Display number to given (first input) register
01DE 900003     217            mov dptr, #T_StuNum ; point to student number lookup table
01E1 7406       217            mov a, #06 ; Load second input into accumulator
01E3 93         217            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
01E4 F58E       217            mov HEX4, a ; Display number to given (first input) register
01E6 900003     217            mov dptr, #T_StuNum ; point to student number lookup table
01E9 7407       217            mov a, #07 ; Load second input into accumulator
01EB 93         217            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
01EC F58F       217            mov HEX5, a ; Display number to given (first input) register ; display first 6 digits
01EE            218            
01EE 02039A     219            ljmp ENDLATCH   
01F1 B80143     220   MODE1:   CJNE r0, #01, MODE2             ; jump if A != byte 
01F4            221            ; Mode 1
01F4 900003     222            mov dptr, #T_StuNum ; point to student number lookup table
01F7 7408       222            mov a, #08 ; Load second input into accumulator
01F9 93         222            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
01FA F591       222            mov HEX0, a ; Display number to given (first input) register
01FC 900003     222            mov dptr, #T_StuNum ; point to student number lookup table
01FF 7408       222            mov a, #08 ; Load second input into accumulator
0201 93         222            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0202 F592       222            mov HEX1, a ; Display number to given (first input) register
0204 900003     222            mov dptr, #T_StuNum ; point to student number lookup table
0207 7408       222            mov a, #08 ; Load second input into accumulator
0209 93         222            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
020A F593       222            mov HEX2, a ; Display number to given (first input) register
020C 900003     222            mov dptr, #T_StuNum ; point to student number lookup table
020F 7408       222            mov a, #08 ; Load second input into accumulator
0211 93         222            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0212 F594       222            mov HEX3, a ; Display number to given (first input) register
0214 900003     222            mov dptr, #T_StuNum ; point to student number lookup table
0217 7408       222            mov a, #08 ; Load second input into accumulator
0219 93         222            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
021A F58E       222            mov HEX4, a ; Display number to given (first input) register
021C 900003     222            mov dptr, #T_StuNum ; point to student number lookup table
021F 7408       222            mov a, #08 ; Load second input into accumulator
0221 93         222            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0222 F58F       222            mov HEX5, a ; Display number to given (first input) register
0224 900003     223            mov dptr, #T_StuNum ; point to student number lookup table
0227 7400       223            mov a, #00 ; Load second input into accumulator
0229 93         223            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
022A F591       223            mov HEX0, a ; Display number to given (first input) register
022C 900003     224            mov dptr, #T_StuNum ; point to student number lookup table
022F 7401       224            mov a, #01 ; Load second input into accumulator
0231 93         224            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0232 F592       224            mov HEX1, a ; Display number to given (first input) register
0234            225                    
0234 02039A     226            ljmp ENDLATCH
0237 B80241     227   MODE2:   CJNE r0, #02, MODE3             ; jump if A != byte 
023A            228            ; Mode 2
023A 900003     229            mov dptr, #T_StuNum ; point to student number lookup table
023D 7400       229            mov a, #00 ; Load second input into accumulator
023F 93         229            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0240 FC         229            mov r4, a ; Display number to given (first input) register
0241 900003     229            mov dptr, #T_StuNum ; point to student number lookup table
0244 7401       229            mov a, #01 ; Load second input into accumulator
0246 93         229            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0247 FD         229            mov r5, a ; Display number to given (first input) register
0248 900003     229            mov dptr, #T_StuNum ; point to student number lookup table
024B 7402       229            mov a, #02 ; Load second input into accumulator
024D 93         229            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
024E F591       229            mov HEX0, a ; Display number to given (first input) register
0250 900003     229            mov dptr, #T_StuNum ; point to student number lookup table
0253 7403       229            mov a, #03 ; Load second input into accumulator
0255 93         229            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0256 F592       229            mov HEX1, a ; Display number to given (first input) register
0258 900003     229            mov dptr, #T_StuNum ; point to student number lookup table
025B 7404       229            mov a, #04 ; Load second input into accumulator
025D 93         229            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
025E F593       229            mov HEX2, a ; Display number to given (first input) register
0260 900003     229            mov dptr, #T_StuNum ; point to student number lookup table
0263 7405       229            mov a, #05 ; Load second input into accumulator
0265 93         229            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0266 F594       229            mov HEX3, a ; Display number to given (first input) register
0268 900003     229            mov dptr, #T_StuNum ; point to student number lookup table
026B 7406       229            mov a, #06 ; Load second input into accumulator
026D 93         229            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
026E F58E       229            mov HEX4, a ; Display number to given (first input) register
0270 900003     229            mov dptr, #T_StuNum ; point to student number lookup table
0273 7407       229            mov a, #07 ; Load second input into accumulator
0275 93         229            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0276 F58F       229            mov HEX5, a ; Display number to given (first input) register ; display first 6 digits
0278 02039A     230            ljmp ENDLATCH
027B B80341     231   MODE3:   CJNE r0, #03, MODE4             ; jump if A != byte 
027E            232            ; Mode 3
027E 900003     233            mov dptr, #T_StuNum ; point to student number lookup table
0281 7400       233            mov a, #00 ; Load second input into accumulator
0283 93         233            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0284 FC         233            mov r4, a ; Display number to given (first input) register
0285 900003     233            mov dptr, #T_StuNum ; point to student number lookup table
0288 7401       233            mov a, #01 ; Load second input into accumulator
028A 93         233            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
028B FD         233            mov r5, a ; Display number to given (first input) register
028C 900003     233            mov dptr, #T_StuNum ; point to student number lookup table
028F 7402       233            mov a, #02 ; Load second input into accumulator
0291 93         233            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0292 F591       233            mov HEX0, a ; Display number to given (first input) register
0294 900003     233            mov dptr, #T_StuNum ; point to student number lookup table
0297 7403       233            mov a, #03 ; Load second input into accumulator
0299 93         233            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
029A F592       233            mov HEX1, a ; Display number to given (first input) register
029C 900003     233            mov dptr, #T_StuNum ; point to student number lookup table
029F 7404       233            mov a, #04 ; Load second input into accumulator
02A1 93         233            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
02A2 F593       233            mov HEX2, a ; Display number to given (first input) register
02A4 900003     233            mov dptr, #T_StuNum ; point to student number lookup table
02A7 7405       233            mov a, #05 ; Load second input into accumulator
02A9 93         233            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
02AA F594       233            mov HEX3, a ; Display number to given (first input) register
02AC 900003     233            mov dptr, #T_StuNum ; point to student number lookup table
02AF 7406       233            mov a, #06 ; Load second input into accumulator
02B1 93         233            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
02B2 F58E       233            mov HEX4, a ; Display number to given (first input) register
02B4 900003     233            mov dptr, #T_StuNum ; point to student number lookup table
02B7 7407       233            mov a, #07 ; Load second input into accumulator
02B9 93         233            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
02BA F58F       233            mov HEX5, a ; Display number to given (first input) register ; display first 6 digits
02BC 02039A     234            ljmp ENDLATCH
02BF B80435     235   MODE4:   CJNE r0, #04, MODE5             ; jump if A != byte 
02C2            236            ; Mode 4
02C2 900003     237            mov dptr, #T_StuNum ; point to student number lookup table
02C5 7400       237            mov a, #00 ; Load second input into accumulator
02C7 93         237            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
02C8 F591       237            mov HEX0, a ; Display number to given (first input) register
02CA 900003     237            mov dptr, #T_StuNum ; point to student number lookup table
02CD 7401       237            mov a, #01 ; Load second input into accumulator
02CF 93         237            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
02D0 F592       237            mov HEX1, a ; Display number to given (first input) register
02D2 900003     237            mov dptr, #T_StuNum ; point to student number lookup table
02D5 7402       237            mov a, #02 ; Load second input into accumulator
02D7 93         237            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
02D8 F593       237            mov HEX2, a ; Display number to given (first input) register
02DA 900003     237            mov dptr, #T_StuNum ; point to student number lookup table
02DD 7403       237            mov a, #03 ; Load second input into accumulator
02DF 93         237            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
02E0 F594       237            mov HEX3, a ; Display number to given (first input) register
02E2 900003     237            mov dptr, #T_StuNum ; point to student number lookup table
02E5 7404       237            mov a, #04 ; Load second input into accumulator
02E7 93         237            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
02E8 F58E       237            mov HEX4, a ; Display number to given (first input) register
02EA 900003     237            mov dptr, #T_StuNum ; point to student number lookup table
02ED 7405       237            mov a, #05 ; Load second input into accumulator
02EF 93         237            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
02F0 F58F       237            mov HEX5, a ; Display number to given (first input) register ; display last 6 digits
02F2 7C00       238            mov r4, #00
02F4 02039A     239            ljmp ENDLATCH
02F7 B80535     240   MODE5:   CJNE r0, #05, MODE6             ; jump if A != byte 
02FA            241            ; Mode 5
02FA 900003     242            mov dptr, #T_StuNum ; point to student number lookup table
02FD 7408       242            mov a, #08 ; Load second input into accumulator
02FF 93         242            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0300 F591       242            mov HEX0, a ; Display number to given (first input) register
0302 900003     242            mov dptr, #T_StuNum ; point to student number lookup table
0305 7408       242            mov a, #08 ; Load second input into accumulator
0307 93         242            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0308 F592       242            mov HEX1, a ; Display number to given (first input) register
030A 900003     242            mov dptr, #T_StuNum ; point to student number lookup table
030D 7408       242            mov a, #08 ; Load second input into accumulator
030F 93         242            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0310 F593       242            mov HEX2, a ; Display number to given (first input) register
0312 900003     242            mov dptr, #T_StuNum ; point to student number lookup table
0315 7408       242            mov a, #08 ; Load second input into accumulator
0317 93         242            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0318 F594       242            mov HEX3, a ; Display number to given (first input) register
031A 900003     242            mov dptr, #T_StuNum ; point to student number lookup table
031D 7408       242            mov a, #08 ; Load second input into accumulator
031F 93         242            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0320 F58E       242            mov HEX4, a ; Display number to given (first input) register
0322 900003     242            mov dptr, #T_StuNum ; point to student number lookup table
0325 7408       242            mov a, #08 ; Load second input into accumulator
0327 93         242            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0328 F58F       242            mov HEX5, a ; Display number to given (first input) register
032A 7C00       243            mov r4, #00
032C 02039A     244            ljmp ENDLATCH
032F B80635     245   MODE6:   CJNE r0, #06, MODE7             ; jump if A != byte 
0332            246            ; Mode 6
0332 900003     247            mov dptr, #T_StuNum ; point to student number lookup table
0335 7408       247            mov a, #08H ; Load second input into accumulator
0337 93         247            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0338 F591       247            mov HEX0, a ; Display number to given (first input) register
033A 900003     247            mov dptr, #T_StuNum ; point to student number lookup table
033D 740C       247            mov a, #12 ; Load second input into accumulator
033F 93         247            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0340 F592       247            mov HEX1, a ; Display number to given (first input) register
0342 900003     247            mov dptr, #T_StuNum ; point to student number lookup table
0345 740B       247            mov a, #11 ; Load second input into accumulator
0347 93         247            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0348 F593       247            mov HEX2, a ; Display number to given (first input) register
034A 900003     247            mov dptr, #T_StuNum ; point to student number lookup table
034D 740B       247            mov a, #11 ; Load second input into accumulator
034F 93         247            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0350 F594       247            mov HEX3, a ; Display number to given (first input) register
0352 900003     247            mov dptr, #T_StuNum ; point to student number lookup table
0355 740A       247            mov a, #10 ; Load second input into accumulator
0357 93         247            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0358 F58E       247            mov HEX4, a ; Display number to given (first input) register
035A 900003     247            mov dptr, #T_StuNum ; point to student number lookup table
035D 7409       247            mov a, #09H ; Load second input into accumulator
035F 93         247            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0360 F58F       247            mov HEX5, a ; Display number to given (first input) register
0362 7C00       248            mov r4, #00
0364 02039A     249            ljmp ENDLATCH
0367            250   MODE7:   ; this should be the "else" case
0367            251            ; Mode 7
0367            252            ; remove 03 and 06
0367 900003     252            mov dptr, #T_StuNum ; point to student number lookup table
036A 7400       252            mov a, #00 ; Load second input into accumulator
036C 93         252            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
036D F591       252            mov HEX0, a ; Display number to given (first input) register
036F 900003     252            mov dptr, #T_StuNum ; point to student number lookup table
0372 7401       252            mov a, #01 ; Load second input into accumulator
0374 93         252            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0375 F592       252            mov HEX1, a ; Display number to given (first input) register
0377 900003     252            mov dptr, #T_StuNum ; point to student number lookup table
037A 7402       252            mov a, #02 ; Load second input into accumulator
037C 93         252            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
037D F593       252            mov HEX2, a ; Display number to given (first input) register
037F 900003     252            mov dptr, #T_StuNum ; point to student number lookup table
0382 7404       252            mov a, #04 ; Load second input into accumulator
0384 93         252            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0385 F594       252            mov HEX3, a ; Display number to given (first input) register
0387 900003     252            mov dptr, #T_StuNum ; point to student number lookup table
038A 7405       252            mov a, #05 ; Load second input into accumulator
038C 93         252            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
038D F58E       252            mov HEX4, a ; Display number to given (first input) register
038F 900003     252            mov dptr, #T_StuNum ; point to student number lookup table
0392 7407       252            mov a, #07 ; Load second input into accumulator
0394 93         252            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0395 F58F       252            mov HEX5, a ; Display number to given (first input) register
0397            253            
0397 02039A     254            ljmp ENDLATCH   
039A            255   ENDLATCH: 
039A            256   
039A            257   ; The code under this label has to do with timekeeping
039A            258   TIMELOGIC:       
039A            259            ; Timing logic
039A D915       260            djnz r1, ENDTICK
039C 7964       261            mov r1, S_TICKS         ; if we got here, that means r1 is zero
039E DA11       262            djnz r2, ENDTICK
03A0            263            ; if we got here, that means r2 is zero
03A0 30EB05     264            JNB SWA.3, LONGERTIME ; Jump if bit = 0
03A3 7A46       265            mov r2, M_TICKS
03A5 0203AA     266            ljmp SHORTERTIME
03A8            267            LONGERTIME:
03A8 7A8C       268            mov r2, M_TICKS_DOUBLE
03AA            269            SHORTERTIME:
03AA DB05       270            djnz r3, ENDTICK
03AC 7B96       271            mov r3, L_TICKS         ; if we got here, that means r3 is zero
03AE 0203B4     272            ljmp HEARTBEAT
03B1            273            
03B1            274            ENDTICK:
03B1 02046F     275            ljmp ENDTIME
03B4            276            
03B4            277   
03B4            278            ; these lines execute once a "heartbeat"
03B4            279   HEARTBEAT:
03B4 B2E8       280            cpl LEDRA.0             ;flip LED to visualize heartbeat
03B6            281            
03B6            282            ; Think of this as a big Switch statement that finds what mode we are in
03B6            283            ; Modes that have time-dependant behavior: 2, 3, 4, 5, 6
03B6 B8021B     284            CJNE r0, #02, MODE3T            ; jump if r0 != byte
03B9            285            ; Mode 2
03B9 8DF0       286            mov b, r5 ; "temp" keep
03BB            286            
03BB EC         286            mov a, r4
03BC FD         286            mov r5, a
03BD AC8F       286            mov r4, HEX5
03BF 858E8F     286            mov HEX5, HEX4
03C2 85948E     286            mov HEX4, HEX3
03C5 859394     286            mov HEX3, HEX2
03C8 859293     286            mov HEX2, HEX1
03CB 859192     286            mov HEX1, HEX0
03CE 85F091     286            mov HEX0, b
03D1 02046F     287            ljmp ENDTIME    
03D4 B8031B     288   MODE3T:  CJNE r0, #03, MODE4T            ; jump if r0 != byte 
03D7            289            ; Mode 3
03D7 8591F0     290            mov b, HEX0 ; "temp" keep
03DA            290            
03DA 859291     290            mov HEX0, HEX1
03DD 859392     290            mov HEX1, HEX2
03E0 859493     290            mov HEX2, HEX3
03E3 858E94     290            mov HEX3, HEX4
03E6 858F8E     290            mov HEX4, HEX5
03E9 8C8F       290            mov HEX5, r4
03EB ED         290            mov a, r5
03EC FC         290            mov r4, a
03ED ADF0       290            mov r5, b
03EF            291                    
03EF 02046F     292            ljmp ENDTIME
03F2 B8046D     293   MODE4T:  CJNE r0, #04, MODE5T            ; jump if A != byte 
03F5            294            ; Mode 4 - Flash
03F5            295            ; if r4 == 0, blank
03F5 BC0035     296            CJNE r4, #00, FLASHJUMP
03F8 900003     297            mov dptr, #T_StuNum ; point to student number lookup table
03FB 7408       297            mov a, #08 ; Load second input into accumulator
03FD 93         297            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
03FE F591       297            mov HEX0, a ; Display number to given (first input) register
0400 900003     297            mov dptr, #T_StuNum ; point to student number lookup table
0403 7408       297            mov a, #08 ; Load second input into accumulator
0405 93         297            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0406 F592       297            mov HEX1, a ; Display number to given (first input) register
0408 900003     297            mov dptr, #T_StuNum ; point to student number lookup table
040B 7408       297            mov a, #08 ; Load second input into accumulator
040D 93         297            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
040E F593       297            mov HEX2, a ; Display number to given (first input) register
0410 900003     297            mov dptr, #T_StuNum ; point to student number lookup table
0413 7408       297            mov a, #08 ; Load second input into accumulator
0415 93         297            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0416 F594       297            mov HEX3, a ; Display number to given (first input) register
0418 900003     297            mov dptr, #T_StuNum ; point to student number lookup table
041B 7408       297            mov a, #08 ; Load second input into accumulator
041D 93         297            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
041E F58E       297            mov HEX4, a ; Display number to given (first input) register
0420 900003     297            mov dptr, #T_StuNum ; point to student number lookup table
0423 7408       297            mov a, #08 ; Load second input into accumulator
0425 93         297            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0426 F58F       297            mov HEX5, a ; Display number to given (first input) register
0428 7C01       298            mov r4, #01
042A 02046F     299            ljmp ENDTIME
042D            300            FLASHJUMP:      
042D 900003     301            mov dptr, #T_StuNum ; point to student number lookup table
0430 7400       301            mov a, #00 ; Load second input into accumulator
0432 93         301            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0433 F591       301            mov HEX0, a ; Display number to given (first input) register
0435 900003     301            mov dptr, #T_StuNum ; point to student number lookup table
0438 7401       301            mov a, #01 ; Load second input into accumulator
043A 93         301            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
043B F592       301            mov HEX1, a ; Display number to given (first input) register
043D 900003     301            mov dptr, #T_StuNum ; point to student number lookup table
0440 7402       301            mov a, #02 ; Load second input into accumulator
0442 93         301            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0443 F593       301            mov HEX2, a ; Display number to given (first input) register
0445 900003     301            mov dptr, #T_StuNum ; point to student number lookup table
0448 7403       301            mov a, #03 ; Load second input into accumulator
044A 93         301            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
044B F594       301            mov HEX3, a ; Display number to given (first input) register
044D 900003     301            mov dptr, #T_StuNum ; point to student number lookup table
0450 7404       301            mov a, #04 ; Load second input into accumulator
0452 93         301            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
0453 F58E       301            mov HEX4, a ; Display number to given (first input) register
0455 900003     301            mov dptr, #T_StuNum ; point to student number lookup table
0458 7405       301            mov a, #05 ; Load second input into accumulator
045A 93         301            movc a, @dptr+a ; Read from table with the input offset. movc means reading from the code dataspace, and the @ is a dereference thing bc its a pointer
045B F58F       301            mov HEX5, a ; Display number to given (first input) register
045D 7C00       302            mov r4, #00
045F 02046F     303            ljmp ENDTIME
0462 B80504     304   MODE5T:  CJNE r0, #05, MODE6T            ; jump if A != byte 
0465            305            ; Mode 5 - One by one
0465 0C         306            inc r4
0466 0200C9     307            ljmp MODE5LONG
0469 B80603     308   MODE6T:  CJNE r0, #06, ENDTIME           ; jump if A != byte 
046C            309            ; Mode 6 - Hello cycle
046C            310            ; Couldn't fit it in so had to do a scuffed long jump away then back
046C 020016     311            ljmp MODE6LONG
046F            312   ENDTIME:
046F            313   
046F 02019F     314            ljmp loop ; Go back up to loop to keep repeating forever
0472            315   END
